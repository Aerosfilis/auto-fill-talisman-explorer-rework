<!DOCTYPE html>
<!--
If you are reading this, it means you are poking around and if you find any errors please comment on my YouTube video!
This was just a work of love and curiosity and actually my first time ever touching HTML and JS.

The offline "research and planning" aspect of Monster Hunter is a community effort and I am proud if this can be a small
contribution, or at least prompt someone else to go off and make a better version.

I normally do not comment on or talk about data-mined stuff but the logic for these talismans are widely shared in both
the JP and western community so I felt it was OK and it has no spoilers. Note they are subject to change.

Happy Hunting!
-->
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/png" href="./favi.png">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Talisman Explorer — Skill &amp; Group Reference</title>
		<style>
			:root { --bg:#0b0f14; --card:#121820; --muted:#94a3b8; --text:#e2e8f0; --border:#1f2937; --accent:#38bdf8; --accent2:#7dd3fc; }
			* { box-sizing: border-box; }
			body { background:var(--bg); color:var(--text); font-family: ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial; margin:0; }
			.wrap { max-width:1100px; margin:32px auto; padding:0 16px; }
			.card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:20px; }
			h1 { margin:0 0 6px 0; }
			p.muted { color:var(--muted); margin-top:0; }
			nav a { color:var(--accent2); text-decoration:none; }
			nav a:hover { text-decoration:underline; }
			.pill { display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; background:#0f1622; border:1px solid var(--border); color:var(--muted); margin-left:8px;}
			details { border:1px solid var(--border); border-radius:12px; padding:10px 12px; background:#0f1622; margin:14px 0; }
			summary { cursor:pointer; font-weight:700; color:var(--accent2); }
			table { width:100%; border-collapse:collapse; margin-top:14px; font-size:14px; }
			th,td { border-bottom:1px solid var(--border); text-align:left; padding:8px; vertical-align: top; }
			th { color:var(--muted); font-weight:600; }
			.grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:16px; margin-top: 16px;}
			.section-card { background:#0f1622; border:1px solid var(--border); border-radius:12px; padding:12px; }
			.section-card h3 { margin:0 0 8px 0; }
			.banner-img { display: block; max-width: 100%; height: auto; margin: 0 auto 20px; border-radius: 12px; }
      nav { margin-bottom: 10px; }
		</style>
	</head>
	<body>
		<div class="wrap">
			<div class="card">
					<a href="./index.html">← Back to Explorer</a>
				</nav>
				<h1>Skill &amp; Group Reference</h1>
				<p class="muted">This page lists all skills and the levels present in each group. It uses the same <code>DATA</code> as the Explorer.</p>

				<img src="./chart.png" alt="Skills Reference" class="banner-img" loading="lazy" />

				<details>
					<summary>All Skills &amp; Levels <span id="skillCount" class="pill"></span></summary>
					<table id="allSkills">
						<thead>
							<tr>
								<th>Skill (English)</th>
								<th>Levels</th>
							</tr>
						</thead>
						<tbody></tbody>
					</table>
				</details>

        <details>
          <summary>Groups <span id="groupCount" class="pill"></span></summary>
				  <div id="groupGrid" class="grid"></div>
        </details>

        <details>
          <summary>Group Sets<span id="groupSetCount" class="pill"></span></summary>
				  <div id="groupSetGrid" class="grid"></div>
        </details>
			</div>
		</div>
	</body>
</html>


<!-- Load the shared dataset FIRST (same folder as this file) -->
<script src="./data.js"></script>

<!-- Build the reference UI -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  // Guard: works with global const declared in data.js
  if (typeof DATA === "undefined") {
    document.body.innerHTML =
      "<p style='color:#f88;padding:20px;font-family:monospace'>" +
      "ERROR: data.js not found. Put your DATA object into data.js and include it before this script." +
      "</p>";
    return;
  }

  const groups = DATA.groups || {};
  const sets = DATA.sets || [];



  ////////////////////////////
  // 1) All Skills & Levels //
  ////////////////////////////

  const skills_all = groups.flatMap((group) => group.skills);

  var skills_grouped = {};
  for (const skill of skills_all) {
    if (skills_grouped.hasOwnProperty(skill.name) && !skills_grouped[skill.name].includes(skill.level))
      skills_grouped[skill.name].push(skill.level);
    else
      skills_grouped[skill.name] = [skill.level];
  }

  const skills_grouped_sorted = Object.entries(skills_grouped).sort((a, b) => a[0].localeCompare(b[0], "en", {sensitivity: "base"}));

  const tbody = document.querySelector("#allSkills tbody");
  for (const [name, levels] of skills_grouped_sorted) {
    const tr = document.createElement("tr");
    const tdName = document.createElement("td");
    tdName.textContent = name;
    
    const tdLvls = document.createElement("td");
    tdLvls.textContent = Array.isArray(levels) ? levels.join(", ") : "";
    
    tr.appendChild(tdName);
    tr.appendChild(tdLvls);
    tbody.appendChild(tr);
  }

  const skill_count = document.getElementById("skillCount");
  if (skill_count) skill_count.textContent = `${skills_grouped_sorted.length} skills`;



  ///////////////
  // 2) Groups //
  ///////////////

  const group_grid = document.getElementById("groupGrid");

  for (const {name, skills} of groups){

    const card = document.createElement("div");
    card.className = "section-card";
    card.innerHTML = `<h3>${name} <span class="pill">${skills.length} skills</span> </h3>`;

    const table = document.createElement("table");
    table.innerHTML = "<thead><tr><th>Skill</th><th>Skill Lv.</th></tr></thead>";

    const tb = document.createElement("tbody");

    for (const skill of skills) {
      const tr = document.createElement("tr");
      const td1 = document.createElement("td");
      td1.textContent = skill.name;

      const td2 = document.createElement("td");
      td2.textContent = skill.level || "—";

      tr.appendChild(td1);
      tr.appendChild(td2);
      tb.appendChild(tr);
    }

    table.appendChild(tb);
    card.appendChild(table);
    group_grid.appendChild(card);
  }

  const group_count = document.getElementById("groupCount");
  if (group_count) group_count.textContent = `${Object.entries(groups).length} groups`;


  
  ///////////////////
  // 3) Group Sets //
  ///////////////////

  const group_set_grid = document.getElementById("groupSetGrid");

  for (set of sets) {
    var set_appended = [];
    set.groups.forEach((group) => set_appended.push(groups[group].skills));
    const skills_all = set_appended.flatMap((group) => group).flatMap((skill) => skill.name).filter((skill, idx, self) => (self.indexOf(skill) == idx)).sort((a, b) => a[0].localeCompare(b[0], "en", {sensitivity: "base"}));

    const card = document.createElement("div");
    card.className = "section-card";
    card.innerHTML = `<h3>${set.name} <span class="pill">${skills_all.length} skills</span> </h3>`;
    card.innerHTML += set.desc;

    const table = document.createElement("table");
    const th = document.createElement("thead");

    const tr1 = document.createElement("tr");
    tr1.innerHTML = `<td>Skill</td><td colspan="${set.groups.length}">Group and Level</td>`;
    th.appendChild(tr1);

    const tr2 = document.createElement("tr");
    const td1 = document.createElement("td");
    td1.textContent = "";
    tr2.appendChild(td1);

    for (group of set.groups) {
      const tdn = document.createElement("td");
      tdn.textContent = "G"+(Number(group)+1);
      tr2.append(tdn);
    }

    th.appendChild(tr2);
    table.appendChild(th);

    const tb = document.createElement("tbody");

    for (skill of skills_all){
      const tr = document.createElement("tr");
      const td1 = document.createElement("td");
      td1.textContent = skill;
      tr.appendChild(td1);

      for (group of set.groups) {
        const tdn = document.createElement("td");
        const skill_listing = groups[group].skills.filter((_skill) => _skill.name == skill);
        if (skill_listing.length > 0)
          tdn.textContent = skill_listing[0].level;
        else
          tdn.textContent = "-";
        tr.appendChild(tdn);
      }
      tb.appendChild(tr);
    }

/*    for (const skill of skills) {
      const tr = document.createElement("tr");
      const td1 = document.createElement("td");
      td1.textContent = skill.name;

      const td2 = document.createElement("td");
      td2.textContent = skill.level || "—";

      tr.appendChild(td1);
      tr.appendChild(td2);
      tb.appendChild(tr);
    }
*/
    table.appendChild(tb);
    card.appendChild(table);
    group_set_grid.appendChild(card);

  }

  const group_set_count = document.getElementById("groupSetCount");
  if (group_set_count) group_set_count.textContent = `${sets.length} sets`;
});

</script>
</body>
</html>
